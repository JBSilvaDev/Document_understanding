### **3. Pacotes de Atividades Essenciais para o Document Understanding**

O framework de Document Understanding (DU) da UiPath é uma solução abrangente para processar documentos, desde a digitalização e classificação até a extração e validação de dados. Ele foi projetado para ser aberto, extensível e versátil, permitindo a combinação de diferentes abordagens para extrair informações de vários tipos de documentos.

Para construir automações de DU, você precisará utilizar pacotes de atividades específicos, que contêm as ferramentas necessárias para cada etapa do processo. Os principais pacotes mencionados são **UiPath.DocumentUnderstanding.Activities**, **UiPath.IntelligentOCR.Activities** e **UiPath.DocumentUnderstanding.ML.Activities**.

#### **A. UiPath.DocumentUnderstanding.Activities**

Este é um dos pacotes mais importantes para o Document Understanding, pois oferece uma estrutura completa para o processamento de documentos. Ele é compatível com fluxos de trabalho do tipo **Windows** e **Multiplataforma** no UiPath Studio.

*   **Visão Geral e Propósito**:
    *   Permite a criação de um fluxo de trabalho unificado para processar diversos tipos de documentos.
    *   Abrange desde a definição da taxonomia (tipos de documentos e campos a serem extraídos) até a digitalização, classificação, extração e validação de dados.
    *   O namespace para este pacote é `UiPath.IntelligentOCR.StudioWeb.Activities`.

*   **Atividades Principais**: Este pacote inclui atividades que permitem manipulação de PDF e tarefas de processamento de documentos:
    *   **Manipulação de PDF**:
        *   `Definir Senha do PDF`: Altera a senha de um arquivo PDF.
        *   `Merge PDFs`: Associa uma coleção de objetos de arquivo PDF.
        *   `Get PDF Page Count`: Fornece o número total de páginas em um arquivo PDF.
        *   `Extract PDF Text`: Extrai o texto de um documento PDF.
        *   `Extract PDF Images`: Extrai todas as imagens encontradas em um arquivo PDF.
        *   `Extract PDF Page Range`: Extrai um intervalo especificado de páginas de um documento PDF.
    *   **Classificação de Documentos**:
        *   `Classificar Documento`: Permite classificar documentos usando um classificador desejado e um documento de entrada.
        *   `Create Classification Validation Task`: Permite criar uma ação de **Validação de documentos** no Action Center.
        *   `Create Classification Validation Task and Wait`: Cria e permite modificar uma ação de **Validação de documento** no Action Center, pausando o fluxo de trabalho até a conclusão da tarefa.
        *   `Aguardar a tarefa de Validação de Classificação e retomar`: Suspende a execução do fluxo de trabalho até que uma ação de validação de documentos especificada seja concluída.
    *   **Extração e Validação de Dados**:
        *   `Extract Document Data`: Extrai dados de um arquivo de entrada ou objeto de dados de documento, armazenando os resultados.
        *   `Criar tarefa de validação e aguardar`: Permite visualizar e modificar os **Resultados da extração** de documentos no Action Center, pausando o fluxo de trabalho até a execução da ação de validação.
        *   `Aguarde a tarefa de validação e retome`: Permite pausar as Actions até que o documento seja validado, retomando automaticamente após a conclusão.
        *   `Create Validation Task`: Permite criar Actions de validação de documentos.

*   **Limitação Conhecida**: Ao usar atividades do tipo "Wait for" que suspendem fluxos de trabalho e trabalham com variáveis `DataTable`, é crucial que essas variáveis sejam **serializáveis**. Se uma variável `DataTable` for inicializada com `new System.Data.DataTable`, ela se torna não serializável e pode causar falhas no projeto. Para evitar isso, você deve deixar o valor padrão da variável `DataTable` vazio ou atribuir um nome a ela, por exemplo: `new System.Data.DataTable("MyTable")`.

*   **Conceito de "Document Data"**: Este pacote faz uso extensivo do objeto `Document Data`, que serve tanto como variável de entrada quanto de saída nos fluxos de trabalho de DU. Ele coleta todas as informações necessárias sobre um único documento, incluindo:
    *   **TipoDeDocumento**: Dados sobre o tipo de documento identificado, preenchido por atividades como `Classify Document`.
    *   **Dados**: Contém os valores de campo extraídos. Pode ser gerado sob demanda como `IDocumentData<ExtractorType>` (padrão) ou, se `Gerar dados` for `False`, pode ser acessado por métodos `Get`.
    *   **DetalhesDoArquivo**: Detalhes sobre o `IResource`, um ponteiro universal para localizar e acessar dados locais ou externos.
    *   **SubDocumentos**: Uma coleção de Dados de Documentos, preenchida pela atividade `Classify Document` (recurso futuro).
    *   **MetadadosDoDocumento**: Informações sobre o processamento do documento, como idioma detectado, campos extraídos como Tabela de Dados, e o Modelo de Objeto do Documento (DOM).

#### **B. UiPath.IntelligentOCR.Activities**

Este pacote também é fundamental para o framework do Document Understanding. Ele é mais adequado para **fluxos de trabalho do tipo Windows-Legacy**.

*   **Visão Geral e Propósito**:
    *   Fornece diversas atividades para digitalização, classificação, extração e validação de dados em documentos.
    *   O framework `Document Understanding` é encontrado dentro deste pacote, e o assistente `Gerenciador de Taxonomia` é acessado através dele.

*   **Atividades Principais**: Este pacote oferece uma ampla gama de funcionalidades:
    *   `Carregar Taxonomia`: Carrega a taxonomia definida para o projeto.
    *   `Digitize Document`: Digitaliza um documento, extraindo seu Modelo de Objeto de Documento (DOM) e texto.
    *   **Classificadores**:
        *   `Classificar Escopo do Documento`: Fornece um escopo para as atividades do classificador, permitindo a configuração de como os classificadores são aplicados.
        *   `Classificador baseado em palavra-chave`: Classifica documentos com base em sequências de strings repetidas (palavras-chave), ideal para documentos com títulos consistentes e conteúdo único por arquivo, com evidências nas primeiras três páginas.
        *   `Document Understanding Project Classifier`: Classifica documentos de um projeto e versão específicos do Document Understanding.
        *   `Intelligent Keyword Classifier`: Utiliza vetores de palavras para classificar e dividir pacotes de documentos em tipos de documentos individuais, sendo útil para arquivos com um ou mais tipos de documentos em um único arquivo e tipos de documentos fáceis de diferenciar. Requer uma Chave de API do Automation Cloud™ Document Understanding™ ou uma instância local no AI Center.
    *   **Estações de Validação**:
        *   `Present Classification Station`: Permite a revisão e correção manual dos resultados da classificação.
        *   `Present Validation Station`: Usado para validação manual e correção dos resultados de dados extraídos automaticamente.
    *   **Ações de Documentos**:
        *   `Create Document Classification Action`: Cria uma ação de classificação de documento.
        *   `Create Document Validation Artifacts`: Cria artefatos para validação de documento.
        *   `Recuperar artefatos de validação de documento`: Recupera artefatos de validação.
        *   `Aguardar ação de classificação do documento e retomar`: Suspende o fluxo de trabalho até a conclusão de uma ação de classificação.
        *   `Rasurar documento`: Permite rasurar informações em um documento.
        *   `Create Document Validation Action`: Cria uma ação de validação de documento.
        *   `Wait For Document Validation Action And Resume`: Aguarda uma ação de validação de documento e retoma.
    *   **Treinamento**:
        *   `Train Classifiers Scope`: Escopo para o treinamento de classificadores.
        *   `Instrutor de Classificador Baseado em Palavra-chave`: Treina o classificador baseado em palavra-chave.
        *   `Intelligent Keyword Classifier Trainer`: Treina o Intelligent Keyword Classifier.
        *   `Escopo da Extração de Dados`: Escopo para atividades de extração, onde extratores são configurados e executados.
        *   `Document Understanding Project Extractor`: Extrator de dados de um projeto específico.
        *   `Document Understanding Project Extractor Trainer`: Treina o extrator de projeto.
        *   `Regex Based Extractor`: Extrai dados com base em expressões regulares.
        *   `Form Extractor`: Extrai dados de formulários.
        *   `Intelligent Form Extractor`: Extrator inteligente de formulários.
        *   `Escopo de Extratores de Treinamento`: Escopo para o treinamento de extratores.
        *   `Exportar Resultados da Extração`: Exporta os resultados da extração.

*   **Importante**: `UiPath.IntelligentOCR.Activities` e `UiPath.DocumentUnderstanding.Activities` **não devem ser usados juntos no mesmo projeto**.

#### **C. UiPath.DocumentUnderstanding.ML.Activities**

Este pacote é essencial para integrar **modelos de Machine Learning (ML)** no seu fluxo de trabalho de Document Understanding.

*   **Visão Geral e Propósito**:
    *   Permite o uso de modelos de Machine Learning (ML) implantados como habilidades de ML no AI Center para classificação e extração de documentos.
    *   É compatível com projetos **Windows** e **Multiplataforma**.

*   **Atividades Principais**:
    *   `Machine Learning Extractor`: Utiliza modelos de ML para extrair dados de documentos.
    *   `Machine Learning Extractor Trainer`: Coleta dados necessários para o treinamento de modelos de ML de extração.
    *   `Machine Learning Classifier`: Usa um modelo de ML implantado como uma habilidade de ML no AI Center para classificar documentos. É recomendado para classificar documentos únicos em diferentes tipos de documentos onde a divisão não é necessária, e para diferenciar entre tipos de documentos personalizados muito semelhantes.
    *   `Machine Learning Classifier Trainer`: Coleta dados para treinar modelos de ML de classificação.
    *   `Classificador Generativo`: Classifica documentos usando modelos generativos, ideal para documentos não estruturados com conteúdo diversificado onde você pode descrever claramente os tipos de documentos em linguagem natural.
        *   **Boas Práticas para Classificador Generativo**:
            *   **Otimização de prompts**: Forneça o máximo de contexto possível e descrições detalhadas de cada tipo de documento. Evite descrições breves e vagas.
            *   **Otimização do fluxo de trabalho**: Crie uma pasta para mover arquivos classificados (evitando reclassificação), crie um conjunto de amostra de documentos (incluindo PDFs corrompidos/protegidos) e use uma atividade `Try Catch` para lidar com falhas. Armazene em cache os resultados da digitalização para economizar tempo em testes repetitivos.
    *   `Extrator Generativo`: Permite a extração de dados usando modelos generativos.
        *   **Boas Práticas para Extrator Generativo**:
            *   **Limitações**: Número de solicitações limitado a 50; resposta de extração (Conclusão) limitada a 700 palavras. Se exceder, divida o documento e mescle os resultados posteriormente.
            *   **Linguagem Precisa**: Use linguagem direta e inequívoca nos prompts, como se estivesse perguntando a várias pessoas e esperando a mesma resposta.
            *   **Formato de Saída Específico**: Especifique o formato desejado para a saída (e.g., `yyyy-mm-dd` para datas, `##,###.##` para números) para reduzir ambiguidade e simplificar o processamento.
            *   **Opções Esperadas**: Forneça um conjunto conhecido de respostas possíveis para perguntas, como opções de múltipla escolha, para aumentar a precisão.
            *   **Abordagem Passo a Passo**: Divida perguntas complexas em etapas simples ou até mesmo em um "programa de computador" com sintaxe JSON/XML para forçar o modelo a seguir instruções e aumentar a precisão.
            *   **Evite Problemas Aritméticos/Lógicos**: Não peça ao extrator para realizar cálculos ou lógica complexa (se-então-senão), pois ele pode cometer erros, é lento e caro comparado a um robô simples.
            *   **Tabelas**: Atualmente não suporta campos de coluna, mas tabelas menores podem ser extraídas com perguntas regulares ou solicitando colunas separadamente ou linhas como objetos JSON. No entanto, não é recomendado para tabelas genéricas/grandes devido à dificuldade da IA Generativa com informações visuais bidimensionais.
            *   **Nível de Confiança**: Modelos de IA Generativa não fornecem níveis de confiança. Uma alternativa é fazer a mesma pergunta de múltiplas maneiras diferentes; a convergência das respostas indica baixa probabilidade de erro. Se houver discordância, a revisão humana pode ser necessária.

#### **C. Outros Pacotes Relacionados e Conceitos Essenciais**

Além dos três principais, outros pacotes e conceitos são cruciais no Document Understanding:

*   **UiPath.DocumentProcessing.Contracts e UiPath.OCR.Contracts**:
    *   Estes pacotes contêm as classes abstratas que permitem aos desenvolvedores criar seus próprios classificadores, extratores e mecanismos de OCR personalizados, estendendo a funcionalidade do framework.

*   **Mecanismos OCR (Optical Character Recognition)**:
    *   Um componente vital do Document Understanding, utilizado na etapa de `Digitalização` para identificar texto em arquivos quando o conteúdo nativo não está disponível (e.g., imagens, PDFs digitalizados).
    *   Os mecanismos de OCR são usados na atividade `Digitize Document`. Eles operam em imagens dentro de uma faixa de resolução específica (mínimo 50x50, máximo 9000x9000 pixels).
    *   **Pacotes de Atividades de OCR**:
        *   `UiPath.OCR.Activities`: Inclui `UiPath Screen OCR`, `UiPath Document OCR` (que precisa de GPU para desempenho ideal, mas pode rodar em CPU com mais recursos), e `UiPath OCR para chinês, japonês e coreano` (descontinuado a partir de jan/2025, recomendado `UiPath Extended Languages OCR`).
        *   `UiPath.OmniPage.Activities`: Contém `OmniPage OCR`.
        *   `Abbyy.Activities`: Inclui `Abbyy OCR` e `Abbyy Cloud OCR`, além de classificadores e extratores específicos do FlexiCapture.
        *   `Abbyy Embedded.Activities`: Contém `Abbyy Screen OCR` e `Abbyy Document OCR`.
        *   `Document Understanding OCR Local Server`: Pacote para OCR em servidor local.
    *   É recomendado testar diferentes mecanismos e suas configurações (Perfil, Escala, Idioma) para encontrar a melhor combinação para cada caso de uso.

*   **UiPath.PDF.Activities**:
    *   Um pacote separado que oferece atividades para interagir com arquivos PDF e XPS, como obter contagem de páginas, ler texto, extrair imagens, gerenciar senhas e unir arquivos. Algumas dessas atividades (como `Get PDF Page Count`, `Extract PDF Text`, `Extract PDF Images`, `Extract PDF Page Range`) também são listadas diretamente sob o pacote `DocumentUnderstanding.Activities`.

*   **UiPath.MLServices.Activities**:
    *   Permite a integração com o AI Center para tarefas como chamar habilidades de ML, fazer upload de arquivos e criar tarefas de rotulagem.

#### **Considerações sobre Compatibilidade**

*   **Windows-Legacy vs. Windows/Multiplataforma**: Como mencionado, `UiPath.IntelligentOCR.Activities` é para fluxos de trabalho `Windows-Legacy`, enquanto `UiPath.DocumentUnderstanding.Activities` é para `Windows` e `Multiplataforma`. Esses pacotes **não devem ser usados juntos no mesmo projeto** para evitar incompatibilidades.
*   **AI Center e Document Understanding**: O AI Center é a infraestrutura que executa os modelos de Machine Learning do UiPath Document Understanding. Modelos de ML pré-treinados podem ser consumidos como endpoints públicos ou implantados como `Habilidades de ML` no AI Center.

Ao entender o propósito e as funcionalidades de cada um desses pacotes de atividades, você estará bem equipado para projetar e implementar soluções eficientes de Document Understanding na plataforma UiPath.