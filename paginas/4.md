**4. Melhores Práticas e Dicas para Novos Usuários**

*   **Comece com o UiPath Studio Web:**
    Para quem está começando, o **UiPath Studio Web** é uma excelente plataforma, pois permite **projetar e criar suas próprias automações sem a necessidade de conhecimento prévio**. Isso o torna ideal para dar os primeiros passos no mundo da automação de documentos.

*   **Use Modelos de Projeto:** O **Processo do Document Understanding™: Modelo do Studio** é um modelo de projeto totalmente funcional no UiPath Studio, baseado em um fluxograma de processamento de documentos.
    *   **O que é:** Ele foi criado para ser uma **ferramenta fácil de usar e executar** para qualquer desenvolvedor que queira criar demonstrações simples ou implementações em larga escala. O modelo já vem pré-configurado com **logging**, **tratamento de exceções**, **mecanismos de repetição** e todos os métodos essenciais para um fluxo de trabalho de Document Understanding. Ele inclui tipos de documentos básicos em uma taxonomia, um classificador configurado para diferenciar entre classes e extratores para demonstrar a extração de dados.
    *   **Benefícios:** Ele serve como um **exemplo de melhores práticas** que pode ser adaptado às suas necessidades, mostrando como configurar cada componente do Document Understanding. A arquitetura é **dissociada**, o que significa que a origem dos arquivos ou o uso das informações extraídas são responsabilidades de processos separados, tornando-o flexível e fácil de escalar e depurar.
    *   **Como acessar:** Você pode encontrar o modelo na aba **"Templates"** do Studio, selecionando o cartão **"Processo do Document Understanding"**. Ele é compatível com o Studio versão 21.4.4 ou superior.

*   **Entenda o Objeto Document Data:** O **Dados do documento** é um recurso fundamental no Document Understanding, servindo tanto como variável de entrada quanto de saída nos seus fluxos de trabalho.
    *   **O que contém:** Este objeto contém todas as informações necessárias sobre um documento específico. Se um documento for classificado, ele inclui o **Tipo de documento**. Se dados forem extraídos, ele contém os **campos extraídos correspondentes**. Independentemente da atividade, o Document Data sempre contém o **texto** e o **DOM (Modelo de Objeto do Documento)** do documento.
    *   **Atributos:** Ele engloba atributos como **TipoDeDocumento** (dados sobre o tipo identificado), **Dados** (valores de campo extraídos), **DetalhesDoArquivo** (nome completo, extensão, intervalo de páginas), **SubDocumentos** (coleção de dados de documentos, a ser preenchida no futuro), e **MetadadosDoDocumento** (idioma detectado, campos como Tabela de Dados, DOM).
    *   **Acesso e Reutilização:** Ele permite coletar todas as informações em uma única variável, salvar dados em cada propriedade e **reutilizá-las em outras atividades do fluxo de trabalho**. Para extrações generativas, os campos recuperados correspondem aos nomes fornecidos no prompt quando **Gerar tipo de dados** está definido como *False*. É uma boa prática **passar o objeto Document Data para as atividades subsequentes** para evitar a digitalização redundante do arquivo. Você pode acessar os dados usando métodos específicos baseados no ID do campo.
    *   **Valores Únicos e Múltiplos:** O sistema retorna resultados em atributos de valor único ou múltiplo, dependendo da configuração do campo na taxonomia. Para múltiplos valores, os resultados aparecem como uma lista.
    *   **Exportar como Tabela de Dados:** É possível retornar os campos extraídos como uma **Tabela de dados** utilizando a saída `ResultsAsDatatable` da atividade `Extract Document Data`, o que facilita o uso em atividades do Excel.

*   **Otimize seus Prompts (Classificador e Extrator Generativo):** O uso de IA generativa requer prompts bem elaborados para máxima eficácia.
    *   **Contexto Amplo:** Ao classificar ou extrair documentos, **forneça o máximo de contexto possível**. Descrições detalhadas de cada tipo de documento (ex: o que é uma fatura) são cruciais para que o modelo generativo funcione de forma eficaz, evitando erros resultantes de descrições breves ou vagas. Para o `Classificador Generativo`, descreva claramente em linguagem natural os tipos de documentos que você deseja classificar, focando nas diferenças entre eles.
    *   **Linguagem Precisa e Formato de Saída:** Utilize **linguagem precisa** em seus prompts, como se estivesse fazendo a pergunta a várias pessoas e esperando a mesma resposta. **Especifique um formato de saída padronizado** para reduzir a ambiguidade, aumentar a precisão e simplificar o processamento subsequente. Por exemplo, peça datas no formato `yyyy-mm-dd` ou números em um formato específico como `##,###.##`.
    *   **Opções Esperadas:** Se a resposta for parte de um conjunto conhecido de opções, **forneça essas opções no prompt**. Isso não só simplifica o processamento, mas também aumenta a precisão. Ex: "Qual é o estado civil do candidato? Respostas possíveis: Casado, Solteiro, Separado, Divorciado, Viúvo, Outro.".
    *   **Passo a Passo:** Para maximizar a precisão em perguntas complexas, **divida-as em etapas simples**. Você pode até escrever a solicitação como um pequeno programa, possivelmente usando sintaxe JSON ou XML, forçando o modelo a seguir instruções de forma mais precisa.
    *   **Evite Operações Aritméticas/Lógicas:** O `Extrator Generativo` **não deve ser usado para realizar somas, multiplicação, subtração, comparações ou lógica complexa** do tipo "se-então-senão". Ele é propenso a erros básicos, lento e caro para essas operações, que são muito mais precisas e eficientes quando feitas por um fluxo de trabalho de robô tradicional.
    *   **Tabelas:** O `Extrator Generativo` **não suporta atualmente campos de coluna diretamente** e tem desafios na extração de tabelas grandes devido à sua operação em sequências lineares de texto, não compreendendo informações visuais bidimensionais. Como solução alternativa, você pode pedir para retornar colunas separadamente ou cada linha como um objeto JSON, mas esteja ciente das restrições.
    *   **Nível de Confiança:** Modelos de IA Generativa **não fornecem níveis de confiança** para suas previsões. Em vez de confiar em níveis de confiança, uma prática melhor para detectar erros é **fazer a mesma pergunta de várias maneiras diferentes**. Se as respostas forem consistentes, a revisão humana pode não ser necessária; caso contrário, a revisão manual no Action Center é recomendada.

*   **Conexão Externa:** Uma **conexão externa** é necessária para criar e executar atividades usando Robôs On-Premises, permitindo que eles consumam recursos de sua organização na nuvem ou de um tenant diferente.
    *   **Configuração:** Você deve adicionar um **aplicativo externo** à sua organização do Automation Cloud, selecionando **Document Understanding** como um recurso e garantindo os escopos de aplicativo necessários (ex: `Du.Extraction.Api` para extração).
    *   **Credenciais:** Salve o **ID do aplicativo** e o **Segredo do aplicativo** gerados.
        *   **Tempo de Design:** Insira as credenciais diretamente na atividade nos campos **ID do aplicativo** e **Segredo do aplicativo**, e o **URL do tenant** (`https://<baseURL>/<OrganizationName>/<TenantName>`).
        *   **Runtime:** Armazene as credenciais em um **Ativo de Credenciais** no Orchestrator local (nome de usuário = ID do aplicativo, senha = Segredo do aplicativo). No fluxo de trabalho, referencie o **Ativo de credenciais de runtime** e o **URL do tenant do runtime** no formato `<OrchestratorFolderName>/<AssetName>`.

*   **Limitação de Variáveis DataTable:** Ao usar atividades do tipo "Wait for" (que suspendem fluxos de trabalho) com variáveis `DataTable`, é crucial que elas sejam **serializáveis**. Se uma variável `DataTable` for inicializada como `new System.Data.DataTable`, ela se torna não serializável e pode causar falhas na execução. Para evitar isso, **deixe o valor padrão da variável `DataTable` vazio ou atribua um nome a ela**, como `new System.Data.DataTable("MyTable")`.

*   **Implantação de Modelos ML:** Para usar modelos de Machine Learning no Document Understanding, como o `Machine Learning Classifier` ou `Extratores Generativos`, eles precisam ser implantados como Habilidades de ML no AI Center.
    *   **Modelos Pré-configurados (Online):** Muitos modelos, como o `UiPathDocumentOCR` e `Faturas`, já estão disponíveis na seção **Pacotes pré-configurados** do AI Center. Basta selecioná-los e submeter.
    *   **Instalação Offline:** Para instalações offline, você precisa baixar o pacote `du` (por exemplo, `dusemistructured-2024.10.0.tar.gz`) e renomeá-lo para `du-ondemand.tar.gz` antes de carregá-lo no AI Center. Para modelos mais antigos (2022.4 e anteriores), pacotes `.zip` são carregados diretamente.
    *   **Implantação de Habilidade de ML:** Após carregar o pacote, crie uma **Habilidade de ML** para ele no AI Center. O `UiPathDocumentOCR` requer configurações avançadas de infraestrutura, como aumentar as **réplicas** (idealmente igual ao número de nós, mas 1 para uso único) e **CPU** (pelo menos 4 para cada réplica) para desempenho ideal, especialmente sem GPU.
    *   **Tornar Pública:** Uma vez que a Habilidade de ML esteja pronta, **torne-a pública** e copie o URL do endpoint para uso em suas atividades do Studio.
    *   **Treinamento de Modelos Personalizados:** Você pode treinar novamente um modelo de ML usando o **Document Manager** para rotular um novo conjunto de dados. Após exportar os documentos rotulados, crie um **pipeline de avaliação** no AI Center, selecionando o pacote de modelo e o conjunto de dados de entrada.